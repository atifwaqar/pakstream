---
---
<!DOCTYPE html>
<html lang="en">
<head>
  {% include google-tag-manager-head.html %}
  <!-- Start cookieyes banner -->
  <script id="cookieyes" type="text/javascript" src="https://cdn-cookieyes.com/client_data/4d58f851fda21f329d07e980/script.js"></script>
  <!-- End cookieyes banner -->
  {% include google-analytics.html %}
  <title>PakStream - Onboard YouTube Channel</title>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta name="description" content="Generate JSON for adding a YouTube channel to all_streams.json.">
  <meta name="robots" content="noindex, nofollow">
  <link rel="canonical" href="https://pakstream.com/onboard-channel.html" />
  <link rel="icon" href="/favicon.ico" type="image/x-icon">
  <link rel="manifest" href="/manifest.webmanifest">
  <meta name="theme-color" content="#ffffff">
  <link rel="stylesheet" href="/css/theme.css">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="preconnect" href="https://fonts.googleapis.com" crossorigin>
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined" rel="stylesheet">
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap">
</head>
<body>
  {% include google-tag-manager-body.html %}
  {% include top-bar.html %}

  <main class="container">
    <h2>Onboard YouTube Channel</h2>
    <p>Enter a YouTube channel URL to generate a JSON snippet for <code>all_streams.json</code>.</p>
    <label for="channel-url">Channel URL</label>
    <input type="text" id="channel-url" name="channel-url" placeholder="https://www.youtube.com/@ImranRiazKhan1" style="width:100%;max-width:400px;">
    <label for="channel-type">Type</label>
    <select id="channel-type" name="channel-type" style="width:100%;max-width:400px;">
      <option value="creator" selected>Creator</option>
      <option value="tv">TV</option>
      <option value="freepress">FreePress</option>
      <option value="radio">Radio</option>
    </select>
    <label for="channel-about">About</label>
    <textarea id="channel-about" name="channel-about" placeholder="Short description" style="width:100%;max-width:400px;"></textarea>
    <button id="fetch-info">Get Channel Info</button>
    <button id="copy-json" aria-label="Copy results" style="display:none;"><span class="material-symbols-outlined">content_copy</span></button>
    <pre id="json-output" style="white-space:pre-wrap;"></pre>
  </main>

  <footer>
    <nav class="footer-nav">
      <a href="/about.html">About Us</a>
      <a href="/contact.html">Contact</a>
      <a href="/privacy.html">Privacy Policy</a>
    <a href="/terms.html">Terms</a>
    </nav>
    {% include support-us.html %}
    <p>Â© 2025 PakStream. All rights reserved.</p>
  </footer>

  <script>
    const API_KEY = 'AIzaSyDUP58EXeb7RtBBy7QJ3jV46bpXQzfSbIs';

    function parseChannelUrl(input) {
      input = input.trim();
      if (!input) {
        return { type: null, value: null, url: null };
      }

      // Full URL provided
      if (/^https?:\/\//i.test(input)) {
        try {
          const u = new URL(input);
          const path = u.pathname;
          if (path.startsWith('/@')) {
            const handle = path.slice(2);
            return { type: 'handle', value: handle, url: `https://www.youtube.com/@${handle}` };
          }
          const parts = path.split('/').filter(Boolean);
          if (parts[0] === 'channel' && parts[1]) {
            const id = parts[1];
            return { type: 'id', value: id, url: `https://www.youtube.com/channel/${id}` };
          }
          if (parts[0]) {
            const custom = parts[0];
            return { type: 'custom', value: custom, url: `https://www.youtube.com/${custom}` };
          }
          return { type: null, value: null, url: null };
        } catch (e) {
          return { type: null, value: null, url: null };
        }
      }

      // Handle-only input like "@name"
      if (input.startsWith('@')) {
        const handle = input.slice(1);
        return { type: 'handle', value: handle, url: `https://www.youtube.com/@${handle}` };
      }

      // Channel ID without URL
      if (/^UC[0-9A-Za-z_-]{22}$/.test(input)) {
        return { type: 'id', value: input, url: `https://www.youtube.com/channel/${input}` };
      }

      // Assume remaining input is a handle
      return { type: 'handle', value: input, url: `https://www.youtube.com/@${input}` };
    }

    document.getElementById('fetch-info').addEventListener('click', async () => {
      const input = document.getElementById('channel-url').value.trim();
      const type = document.getElementById('channel-type').value;
      const about = document.getElementById('channel-about').value.trim();
      const output = document.getElementById('json-output');
      const copyBtn = document.getElementById('copy-json');
      output.textContent = '';
      copyBtn.style.display = 'none';
      if (!input) return;

      const parsed = parseChannelUrl(input);
      if (!parsed.value) {
        output.textContent = 'Invalid channel URL or handle';
        return;
      }
      const channelUrl = parsed.url;

      let apiUrl;
      if (parsed.type === 'handle') {
        apiUrl = `https://www.googleapis.com/youtube/v3/channels?part=id,snippet&forHandle=${encodeURIComponent(parsed.value)}&key=${API_KEY}`;
      } else if (parsed.type === 'id') {
        apiUrl = `https://www.googleapis.com/youtube/v3/channels?part=id,snippet&id=${encodeURIComponent(parsed.value)}&key=${API_KEY}`;
      } else {
        apiUrl = `https://www.googleapis.com/youtube/v3/channels?part=id,snippet&forUsername=${encodeURIComponent(parsed.value)}&key=${API_KEY}`;
      }

      try {
        const response = await fetch(apiUrl);
        const data = await response.json();
        if (!data.items || data.items.length === 0) {
          output.textContent = 'Channel not found';
          return;
        }
        const item = data.items[0];
        const channelId = item.id;
        const name = item.snippet.title;
        const thumb = item.snippet.thumbnails?.high?.url || item.snippet.thumbnails?.default?.url || '';
        const handle = item.snippet.customUrl ? item.snippet.customUrl.replace(/^@/, '') : parsed.value;
        const key = handle.toLowerCase().replace(/[^a-z0-9]+/g, '');

        // Check for existing channel in all_streams.json
        try {
          const existingResp = await fetch('/all_streams.json');
          const existingData = await existingResp.json();
          const exists = existingData.items?.some(it => it.ids?.youtube_channel_id === channelId);
          if (exists) {
            output.textContent = 'Channel already exists in all_streams.json';
            return;
          }
        } catch (e) {
          // If we can't fetch the list, continue without the check
        }

        const result = {
          key: key,
          name: name,
          type: type,
          platform: 'youtube',
          about: about,
          media: { thumbnail_url: thumb },
          endpoints: [
            { kind: 'embed', provider: 'youtube', url: `https://www.youtube-nocookie.com/embed/live_stream?channel=${channelId}` },
            { kind: 'channel', provider: 'youtube', url: channelUrl }
          ],
          ids: { youtube_channel_id: channelId },
          status: { active: true }
        };
        output.textContent = JSON.stringify(result, null, 2);
        copyBtn.style.display = 'inline-block';
      } catch (err) {
        output.textContent = 'Error fetching channel info';
      }
    });

    document.getElementById('copy-json').addEventListener('click', () => {
      const text = document.getElementById('json-output').textContent;
      navigator.clipboard.writeText(text);
    });
  </script>
  <script src="/js/pwa.js" defer></script>
  <script defer src="/js/main.js"></script>
</body>
</html>
